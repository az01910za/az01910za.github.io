<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="John Doe"><link rel="alternative" href="/atom.xml" title="昵称不可为空" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>防火墙 - 昵称不可为空</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">昵称不可为空</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="/archives">目录</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2019-07-27T16:23:02.888Z">2019 - 07 - 28 00:23:02</time><h1 class="post__title"><a href="/2019/07/28/防火墙/">防火墙</a></h1><div class="post__main echo"><h2 id="添加80端口通过的规则"><a href="#添加80端口通过的规则" class="headerlink" title="添加80端口通过的规则"></a>添加80端口通过的规则</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--zone  drop：默认丢弃所有包</span><br><span class="line">        block：拒绝所有外部连接，允许内部发起的连接</span><br><span class="line">        public：指定外部连接可以进入</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--add-port   指定添加端口    80/tcp   53/udp</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--add-service  指定常见服务    http https mysql mssql ssh 80/http  443/https 3306/mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--permanent  永久生效</span><br></pre></td></tr></table></figure>

<h2 id="删除80端口通过的规则"><a href="#删除80端口通过的规则" class="headerlink" title="删除80端口通过的规则"></a>删除80端口通过的规则</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=80/tcp --permanent</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--remove-port     指定删除端口 </span><br><span class="line">--remove-service  指定删除服务</span><br></pre></td></tr></table></figure>

<h3 id="防火墙更新规则"><a href="#防火墙更新规则" class="headerlink" title="防火墙更新规则"></a>防火墙更新规则</h3><p>firewall-cmd –reload</p>
<h3 id="防火墙显示所有规则"><a href="#防火墙显示所有规则" class="headerlink" title="防火墙显示所有规则"></a>防火墙显示所有规则</h3><p>firewall-cmd –list-all</p>
<h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><p>systemctl stop firewalld</p>
<h3 id="查看防火墙状态"><a href="#查看防火墙状态" class="headerlink" title="查看防火墙状态"></a>查看防火墙状态</h3><p>systemctl status firewalld</p>
<h3 id="启动防火墙"><a href="#启动防火墙" class="headerlink" title="启动防火墙"></a>启动防火墙</h3><p>systemctl start firewalld</p>
<p>Centos6<br>Iptables<br>Service iptables start/stop/restart<br>Centos 7     systemctl stop/start/restart firewalld<br>Ubuntu      service ufw start/stop/restart</p>
<h3 id="Filter功能是防火墙一个重要功能，它定义数据通过允许或者不允许，控制数据类型有二类：INPUT，OUTPUT"><a href="#Filter功能是防火墙一个重要功能，它定义数据通过允许或者不允许，控制数据类型有二类：INPUT，OUTPUT" class="headerlink" title="Filter功能是防火墙一个重要功能，它定义数据通过允许或者不允许，控制数据类型有二类：INPUT，OUTPUT"></a>Filter功能是防火墙一个重要功能，它定义数据通过允许或者不允许，控制数据类型有二类：INPUT，OUTPUT</h3><h2 id="配置文件-etc-sysconfig-iptables"><a href="#配置文件-etc-sysconfig-iptables" class="headerlink" title="配置文件  /etc/sysconfig/iptables"></a>配置文件  /etc/sysconfig/iptables</h2><p>配置文件从上至下优先权依次减小<br>改后重启service iptables restart<br>iptables -nvL  查看防火墙规则<br>Iptables命令：</p>
<p>-A 追加<br>-p 指定协议类型</p>
<p>三种tcp  udp  icmp</p>
<pre><code>tcp通过dport指定目标端口，sport指定源端口

udp一样

icmp通过 –icmp-type指定类型，0是响应型数据包，8是请求数据包</code></pre><p>-m表示启用拓展功能，<br>    一般和-p配合，-p指定类型后，通过-m打开此类型的拓展功能</p>
<p>-j 指定如何进行处理DROP丢弃REJECT拒绝 ACCEPT通过</p>
<h3 id="Linux原来iptables配置文件"><a href="#Linux原来iptables配置文件" class="headerlink" title="Linux原来iptables配置文件"></a>Linux原来iptables配置文件</h3><p>-A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT<br>-A INPUT -p icmp -j ACCEPT<br>-A INPUT -I lo -j ACCEPT<br>-A INPUT -m state –state NEW -m tcp -p tcp –dport 22 -j ACCEPT</p>
<h3 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h3><p>-A INPUT/OUTPUT -j DROP/REJECT/ACCEPT<br>-A INPUT -j drop<br>-A INPUT -j ACCEPT<br>-A INPUT -p tcp/udp -m tcp –dport 80 -j ACCEPT<br>-A INPUT -p tcp/udp -m tcp –dport 3306 -j ACCEPT<br>-A INPUT -p icmp -m icmp –icmp-type 0 -j DROP<br>-A OUTPUT -p tcp -m tcp –dport 443 -j DROP</p>
</div></header></article><section class="reward"><a class="btn-reward" href="#">打赏</a><div class="reward-wrapper clearfix"><img src="/img/wechat.png" title="微信"></div></section></main><footer class="foot"><div class="foot-copy">&copy; 2016 - 2019 John Doe</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>